name: PR Build

on:
  pull_request:
    branches:
      - main
  workflow_dispatch: {}
# TODO: Remove /\ once finished testing

jobs:
  aws-auth:
    uses: ./.github/workflows/aws-auth.yml

  ci:
    needs: aws-auth
    uses: ./.github/workflows/ci.yml
    with:
      code_artifact_token: ${{ needs.aws-auth.outputs.code_artifact_token }}
    secrets:
      AZURE_PACKAGE_READ_WRITE: ${{ secrets.AZURE_PACKAGE_READ_WRITE }}